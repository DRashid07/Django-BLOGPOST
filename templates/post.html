{% extends 'base.html' %}
{% load markdown_extras %}
{% block content %}

<body class="bg-gray-100 font-sans leading-normal tracking-normal"> 

	<!-- <nav id="header" class="fixed w-full z-10 top-0">

		<div id="progress" class="h-1 z-20 top-0" style="background:linear-gradient(to right, #4dc0b5 var(--scroll), transparent 0);"></div>

		<div class="w-full md:max-w-4xl mx-auto flex flex-wrap items-center justify-between mt-0 py-3">

			<div class="pl-4">
				<a class="text-gray-900 text-base no-underline hover:no-underline font-extrabold text-xl" href="#">
					Minimal Blog
				</a>
			</div>

			<div class="block lg:hidden pr-4">
				<button id="nav-toggle" class="flex items-center px-3 py-2 border rounded text-gray-500 border-gray-600 hover:text-gray-900 hover:border-green-500 appearance-none focus:outline-none">
					<svg class="fill-current h-3 w-3" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
						<title>Menu</title>
						<path d="M0 3h20v2H0V3zm0 6h20v2H0V9zm0 6h20v2H0v-2z" />
					</svg>
				</button>
			</div>

			<div class="w-full flex-grow lg:flex lg:items-center lg:w-auto hidden lg:block mt-2 lg:mt-0 bg-gray-100 md:bg-transparent z-20" id="nav-content">
				<ul class="list-reset lg:flex justify-end flex-1 items-center">
					<li class="mr-3">
						<a class="inline-block py-2 px-4 text-gray-900 font-bold no-underline" href="#">Active</a>
					</li>
					<li class="mr-3">
						<a class="inline-block text-gray-600 no-underline hover:text-gray-900 hover:text-underline py-2 px-4" href="#">link</a>
					</li>
					<li class="mr-3">
						<a class="inline-block text-gray-600 no-underline hover:text-gray-900 hover:text-underline py-2 px-4" href="#">link</a>
					</li>
				</ul>
			</div>
		</div>
	</nav> -->

	<!--Container-->
	<div class="container w-full md:max-w-3xl mx-auto pt-20">

		<div class="w-full px-4 md:px-6 text-xl text-gray-800 leading-normal" style="font-family:Georgia,serif;">

			<!--Title-->
			<div class="font-sans">
						<h1 class="font-bold font-sans break-normal text-gray-900 pt-6 pb-2 text-3xl md:text-4xl">
						{{ post.title }}</h1>
						<p class="text-sm md:text-base font-normal text-gray-600">
						{{ obj.timestamp}}</p>
						<img class="h-40 rounded w-full object-cover object-center mb-6" src="{{ post.thumbnail.url }}" alt="content">
			</div>


			<!--Post Content-->

			<div class="py-6">
			{{ post.content | markdown | safe }}
			</div>


		

		

			<ol>
				<li class="py-3">Maecenas accumsan lacus sit amet elementum porta. Aliquam eu libero lectus. Fusce vehicula dictum mi. In non dolor at sem ullamcorper venenatis ut sed dui. Ut ut est quam. Suspendisse quam quam, commodo sit amet placerat in, interdum a ipsum. Morbi sit amet tellus scelerisque tortor semper posuere.</li>
				<li class="py-3">Morbi varius posuere blandit. Praesent gravida bibendum neque eget commodo. Duis auctor ornare mauris, eu accumsan odio viverra in. Proin sagittis maximus pharetra. Nullam lorem mauris, faucibus ut odio tempus, ultrices aliquet ex. Nam id quam eget ipsum luctus hendrerit. Ut eros magna, eleifend ac ornare vulputate, pretium nec felis.</li>
				<li class="py-3">Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia Curae; Nunc vitae pretium elit. Cras leo mauris, tristique in risus ac, tristique rutrum velit. Mauris accumsan tempor felis vitae gravida. Cras egestas convallis malesuada. Etiam ac ante id tortor vulputate pretium. Maecenas vel sapien suscipit, elementum odio et, consequat tellus.</li>
			</ol>

	


			<!--/ Post Content-->

		</div>

		

		<!--Divider-->
		<hr class="border-b-2 border-gray-400 mb-8 mx-4">



		<!--Author-->
		<div class="flex w-full items-center font-sans px-4 py-12">
			<img class="w-10 h-10 rounded-full mr-4" src="{{ post.author.profile_picture.url }}">
			<div class="flex-1 px-2">
				<p class="text-base font-bold text-base md:text-xl leading-none mb-2">
				{{ post.author }}</p>
		
			</div>
			
		</div>
		<!--/Author-->

		<!--Divider-->
		<hr class="border-b-2 border-gray-400 mb-8 mx-4">

<!--Like Section-->
<div class="px-4 py-6 text-center">
    {% if user.is_authenticated %}
        <form method="POST" action="/like/{{ post.slug }}/" style="display:inline;">
            {% csrf_token %}
            <button type="submit" class="inline-flex items-center px-6 py-3 rounded-full text-white font-bold shadow-lg hover:shadow-xl transition-all"
                    style="background: {% if user_has_liked %}#ef4444{% else %}#3b82f6{% endif %};">
                <svg class="w-6 h-6 mr-2" fill="currentColor" viewBox="0 0 20 20">
                    <path d="M3.172 5.172a4 4 0 015.656 0L10 6.343l1.172-1.171a4 4 0 115.656 5.656L10 17.657l-6.828-6.829a4 4 0 010-5.656z"/>
                </svg>
                {% if user_has_liked %}
                    Bəyəndin
                {% else %}
                    Bəyən
                {% endif %}
                <span class="ml-2 bg-white bg-opacity-30 px-3 py-1 rounded-full">{{ total_likes }}</span>
            </button>
        </form>
    {% else %}
        <a href="{% url 'admin:login' %}?next={{ request.path }}" 
           class="inline-flex items-center px-6 py-3 bg-gray-500 hover:bg-gray-600 rounded-full text-white font-bold shadow-lg transition-all">
            <svg class="w-6 h-6 mr-2" fill="currentColor" viewBox="0 0 20 20">
                <path d="M3.172 5.172a4 4 0 015.656 0L10 6.343l1.172-1.171a4 4 0 115.656 5.656L10 17.657l-6.828-6.829a4 4 0 010-5.656z"/>
            </svg>
            Bəyənmək üçün daxil ol
            <span class="ml-2 bg-white bg-opacity-30 px-3 py-1 rounded-full">{{ total_likes }}</span>
        </a>
    {% endif %}
</div>

<!--Favourite Section-->
<div class="px-4 py-6 text-center">
    {% if user.is_authenticated %}
        <form method="POST" action="/favourite/{{ post.slug }}/" style="display:inline;">
            {% csrf_token %}
            <button type="submit" class="inline-flex items-center px-6 py-3 rounded-full text-white font-bold shadow-lg hover:shadow-xl transition-all"
                    style="background: {% if user_has_favourited %}#f59e0b{% else %}#6b7280{% endif %};">
                <svg class="w-6 h-6 mr-2" fill="currentColor" viewBox="0 0 20 20">
                    <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"/>
                </svg>
                {% if user_has_favourited %}
                    Seçilmişlərdən sil
                {% else %}
                    Seçilmişlərə əlavə et
                {% endif %}
            </button>
        </form>
    {% else %}
        <a href="{% url 'admin:login' %}?next={{ request.path }}" 
           class="inline-flex items-center px-6 py-3 bg-gray-400 rounded-full text-white font-bold">
            ⭐ Seçilmişlər üçün daxil ol
        </a>
    {% endif %}
</div>

<!--Divider-->
<hr class="border-b-2 border-gray-400 mb-8 mx-4">

<!--Comments Section-->
<div class="px-4 py-6">
    <h2 class="font-bold text-2xl mb-4">Şərhlər ({{ comments.count }})</h2>
    
    <!-- Comment Form -->
    <div class="bg-white rounded-lg shadow-md p-6 mb-6">
        <h3 class="font-bold text-xl mb-4">Şərh yaz</h3>
        <form method="POST">
            {% csrf_token %}
            <div class="mb-4">
                <label class="block text-gray-700 mb-2">Ad:</label>
                <input type="text" name="name" class="w-full border rounded px-3 py-2" required>
            </div>
            <div class="mb-4">
                <label class="block text-gray-700 mb-2">Şərh:</label>
                <textarea name="body" class="w-full border rounded px-3 py-2" rows="4" required></textarea>
            </div>
            <button type="submit" class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded">
                Göndər
            </button>
        </form>
    </div>
    
    <!-- Comments List -->
    {% for comment in comments %}
    <div class="bg-gray-50 rounded-lg p-4 mb-4">
        <div class="font-bold text-lg">{{ comment.name }}</div>
        <div class="text-gray-600 text-sm mb-2">{{ comment.created_at|date:"d M Y, H:i" }}</div>
        <p class="text-gray-800">{{ comment.body }}</p>
    </div>
    {% empty %}
    <p class="text-gray-500">Hələ şərh yoxdur. Birinci şərhi siz yazın!</p>
    {% endfor %}
</div>
<!--/Comments Section-->

	</div>
	<!--/container-->

	

	<script>
		/* Progress bar */
		//Source: https://alligator.io/js/progress-bar-javascript-css-variables/
		var h = document.documentElement,
			b = document.body,
			st = 'scrollTop',
			sh = 'scrollHeight',
			progress = document.querySelector('#progress'),
			scroll;
		var scrollpos = window.scrollY;
		var header = document.getElementById("header");
		var navcontent = document.getElementById("nav-content");

		document.addEventListener('scroll', function() {

			/*Refresh scroll % width*/
			scroll = (h[st] || b[st]) / ((h[sh] || b[sh]) - h.clientHeight) * 100;
			progress.style.setProperty('--scroll', scroll + '%');

			/*Apply classes for slide in bar*/
			scrollpos = window.scrollY;

			if (scrollpos > 10) {
				header.classList.add("bg-white");
				header.classList.add("shadow");
				navcontent.classList.remove("bg-gray-100");
				navcontent.classList.add("bg-white");
			} else {
				header.classList.remove("bg-white");
				header.classList.remove("shadow");
				navcontent.classList.remove("bg-white");
				navcontent.classList.add("bg-gray-100");

			}

		});


		//Javascript to toggle the menu
		document.getElementById('nav-toggle').onclick = function() {
			document.getElementById("nav-content").classList.toggle("hidden");
		}
	</script>

<!-- </body> -->

{% endblock content %}
