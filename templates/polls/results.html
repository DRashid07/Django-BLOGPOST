{% extends 'base.html' %}

{% block content %}
<div class="container w-full md:max-w-3xl mx-auto pt-20">
    <div class="w-full px-4 md:px-6 text-xl text-gray-800 leading-normal">
        
        <div class="font-sans">
            <h1 class="font-bold font-sans break-normal text-gray-900 pt-6 pb-2 text-3xl md:text-4xl">
                {{ question.question_text }}
            </h1>
            <p class="text-sm md:text-base font-normal text-gray-600 mb-8">
                {{ question.pub_date|date:"d M Y, H:i" }}
            </p>
        </div>

        <div class="bg-white shadow-lg rounded-lg p-8">
            <h2 class="text-2xl font-bold mb-6 text-gray-900">Nəticələr:</h2>
            
            {% for choice in question.choices.all %}
            <div class="mb-6">
                <div class="flex justify-between items-center mb-2">
                    <span class="text-lg font-semibold text-gray-700">{{ choice.choice_text }}</span>
                    <span class="text-lg font-bold text-pink-600">{{ choice.votes }} səs</span>
                </div>
                
                <!-- Progress Bar -->
                {% if question.choices.all|length > 0 %}
                    {% widthratio choice.votes question.choices.all.0.votes|add:question.choices.all.1.votes|default:1 100 as percentage %}
                {% else %}
                    {% widthratio choice.votes 1 100 as percentage %}
                {% endif %}
                
                <div class="w-full bg-gray-200 rounded-full h-4 overflow-hidden">
                    <div class="bg-gradient-to-r from-pink-400 to-pink-600 h-4 rounded-full transition-all duration-500" 
                         style="width: {% if choice.votes > 0 %}{{ percentage }}%{% else %}0%{% endif %}">
                    </div>
                </div>
                <p class="text-sm text-gray-500 mt-1">
                    {% if choice.votes > 0 %}{{ percentage }}%{% else %}0%{% endif %}
                </p>
            </div>
            {% endfor %}

            <div class="mt-8 pt-6 border-t border-gray-200">
                <p class="text-lg text-gray-600 mb-4">
                    <strong>Ümumi səs sayı:</strong> 
                    <span class="text-pink-600 font-bold">
                        {{ question.choices.all|length }}
                    </span>
                </p>
                
                <div class="flex gap-4">
                    <a href="{% url 'polls:detail' question.id %}" 
                       class="bg-pink-500 hover:bg-pink-700 text-white font-bold py-3 px-6 rounded-lg transition-colors">
                        Yenidən səs ver
                    </a>
                    <a href="{% url 'polls:index' %}" 
                       class="bg-gray-500 hover:bg-gray-700 text-white font-bold py-3 px-6 rounded-lg transition-colors">
                        Bütün sorğular
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
